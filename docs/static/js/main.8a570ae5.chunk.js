(this["webpackJsonpwolke-admin"]=this["webpackJsonpwolke-admin"]||[]).push([[0],{73:function(e,t,n){},74:function(e,t,n){},86:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n.n(a),c=n(10),r=n.n(c),o=(n(73),n(47)),i=n(13),u=n(30),l=(n(74),n(127)),d=n(124),j=n(90),b=n(125),m=n(129),h=n(122),O=n(126),f=n(130),p=n(131),v=n(59),g=n.n(v),x=n(88),_=n(52),w=n(53),N="https://wolke.glencoden.de",k="".concat(N,"/auth"),C="".concat(N,"/cards");function A(e){return e.ok?e.json():e.json().then((function(e){return Promise.reject(e)}))}var y=new(function(){function e(){Object(_.a)(this,e),this._oAuth2_access_token=""}return Object(w.a)(e,[{key:"_get",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"".concat(N,"/test/auth"),t={"Content-Type":"application/json; charset=utf-8"};return this._oAuth2_access_token&&(t.Authorization="Bearer ".concat(this._oAuth2_access_token)),Promise.resolve().then((function(){return fetch(e,{method:"GET",headers:t})})).then(A)}},{key:"_post",value:function(e,t){var n={"Content-Type":"application/json; charset=utf-8"};return this._oAuth2_access_token&&(n.Authorization="Bearer ".concat(this._oAuth2_access_token)),Promise.resolve().then((function(){return JSON.stringify(t)})).then((function(t){return fetch(e,{method:"POST",headers:n,body:t})})).then(A)}},{key:"_postEncodeURI",value:function(e,t){return Promise.resolve().then((function(){return function(e){var t=[];for(var n in e){var a=encodeURIComponent(n),s=encodeURIComponent(e[n]);t.push("".concat(a,"=").concat(s))}return t.join("&")}(t)})).then((function(t){return fetch(e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},body:t})})).then(A)}},{key:"loginToWolke",value:function(e){var t=this,n=e.username,a=e.password;return this._postEncodeURI("".concat(k,"/login"),{username:n,password:a,grant_type:"password",client_id:null,client_secret:null}).then((function(e){return e.access_token?(t._oAuth2_access_token=e.access_token,{success:!0}):{success:!1}}))}},{key:"getOAuthUsers",value:function(e){var t=e.admin_password;return this._post("".concat(k,"/get_all"),{admin_password:t})}},{key:"registerOAuthUser",value:function(e){var t=e.username,n=e.password,a=e.admin_password;return this._post("".concat(k,"/register"),{username:t,password:n,admin_password:a,grant_type:"password"})}},{key:"deleteOAuthUser",value:function(e){var t=e.username,n=e.admin_password;return this._post("".concat(k,"/delete"),{username:t,admin_password:n,grant_type:"password"})}},{key:"getCardsUsers",value:function(){return this._get("".concat(C,"/all_users"))}},{key:"registerCardsUser",value:function(e){var t=e.name,n=e.isAdmin,a=e.from,s=e.to,c=e.admin_password;return this._post("".concat(C,"/upsert_user"),{name:t,isAdmin:n,from:a,to:s,admin_password:c})}},{key:"deleteCardsUser",value:function(e){var t=e.name,n=e.admin_password;return this._post("".concat(C,"/delete_user"),{name:t,admin_password:n})}}]),e}()),S=n(4);var U=function(e){var t=e.adminPassword,n=Object(a.useState)(""),s=Object(i.a)(n,2),c=s[0],r=s[1],o=Object(a.useState)(""),u=Object(i.a)(o,2),d=u[0],b=u[1],m=Object(a.useState)(""),h=Object(i.a)(m,2),O=h[0],f=h[1],p=Object(a.useState)([]),v=Object(i.a)(p,2),g=v[0],_=v[1];return Object(a.useEffect)((function(){y.getOAuthUsers({admin_password:t}).then((function(e){e.success?_(e.users):console.log("something went wrong getting oAuth users")}))}),[t]),Object(S.jsxs)(S.Fragment,{children:[Object(S.jsxs)("div",{className:"center-column",children:[Object(S.jsx)(x.a,{className:"title",children:"Register OAuth2 User"}),Object(S.jsx)(l.a,{className:"input-field",label:"name",value:c,onChange:function(e){var t=e.target;return r(t.value)}}),Object(S.jsx)(l.a,{className:"input-field",label:"password",value:d,onChange:function(e){var t=e.target;return b(t.value)}}),Object(S.jsx)(j.a,{className:"cta-button",variant:"contained",onClick:function(){y.registerOAuthUser({username:c,password:d,admin_password:t}).then((function(e){return console.log(e)}))},children:"Register"})]}),Object(S.jsxs)("div",{className:"center-column",children:[Object(S.jsx)(x.a,{className:"title",children:"Delete OAuth2 User"}),Object(S.jsx)(l.a,{className:"input-field",label:"name",value:O,onChange:function(e){var t=e.target;return f(t.value)}}),Object(S.jsx)(j.a,{className:"cta-button",variant:"contained",onClick:function(){y.deleteOAuthUser({username:O,admin_password:t}).then((function(e){return console.log(e)}))},children:"Delete"})]}),Object(S.jsxs)("div",{className:"center-column",children:[Object(S.jsx)(x.a,{className:"title",children:"All Users"}),g.map((function(e,t){return Object(S.jsx)(x.a,{className:"title",color:"textSecondary",variant:"caption",children:e.username},t)}))]})]})},T=n(123),P=n(128);function R(e){return e.split(", ")}var E=function(e){var t=e.adminPassword,n=Object(a.useState)(""),s=Object(i.a)(n,2),c=s[0],r=s[1],o=Object(a.useState)(""),u=Object(i.a)(o,2),d=u[0],b=u[1],m=Object(a.useState)(""),h=Object(i.a)(m,2),O=h[0],f=h[1],p=Object(a.useState)(!1),v=Object(i.a)(p,2),g=v[0],_=v[1],w=Object(a.useState)(""),N=Object(i.a)(w,2),k=N[0],C=N[1],A=Object(a.useState)([]),U=Object(i.a)(A,2),E=U[0],D=U[1];return Object(a.useEffect)((function(){y.getCardsUsers().then((function(e){e.success?D(e.users):console.log("something went wrong getting cards users")}))}),[]),Object(S.jsxs)(S.Fragment,{children:[Object(S.jsxs)("div",{className:"center-column",children:[Object(S.jsx)(x.a,{className:"title",children:"Register Cards User"}),Object(S.jsx)(l.a,{className:"input-field",label:"name",value:c,onChange:function(e){var t=e.target;return r(t.value)}}),Object(S.jsx)(l.a,{className:"input-field",label:"from",value:d,onChange:function(e){var t=e.target;return b(t.value)}}),Object(S.jsx)(l.a,{className:"input-field",label:"to",value:O,onChange:function(e){var t=e.target;return f(t.value)}}),Object(S.jsx)(T.a,{className:"checkbox",control:Object(S.jsx)(P.a,{checked:g,onChange:function(){return _((function(e){return!e}))},name:"checkedA"}),label:"is admin"}),Object(S.jsx)(j.a,{className:"cta-button",variant:"contained",onClick:function(){y.registerCardsUser({admin_password:t,name:c,from:R(d),to:R(O),isAdmin:g}).then((function(e){return console.log(e)}))},children:"Register"})]}),Object(S.jsxs)("div",{className:"center-column",children:[Object(S.jsx)(x.a,{className:"title",children:"Delete Cards User"}),Object(S.jsx)(l.a,{className:"input-field",label:"name",value:k,onChange:function(e){var t=e.target;return C(t.value)}}),Object(S.jsx)(j.a,{className:"cta-button",variant:"contained",onClick:function(){y.deleteCardsUser({admin_password:t,name:k}).then((function(e){return console.log(e)}))},children:"Delete"})]}),Object(S.jsxs)("div",{className:"center-column",children:[Object(S.jsx)(x.a,{className:"title",children:"All Users"}),E.map((function(e,t){return Object(S.jsx)(x.a,{className:"title",color:"textSecondary",variant:"caption",children:e.name},t)}))]})]})};var D,I=function(e){var t=e.onSuccess,n=Object(a.useState)(""),s=Object(i.a)(n,2),c=s[0],r=s[1],o=Object(a.useState)(""),u=Object(i.a)(o,2),d=u[0],b=u[1];return Object(S.jsxs)("div",{className:"center-column",children:[Object(S.jsx)(x.a,{className:"title",children:"Login"}),Object(S.jsx)(l.a,{className:"input-field",label:"username",value:c,onChange:function(e){var t=e.target;return r(t.value)}}),Object(S.jsx)(l.a,{type:"password",className:"input-field",label:"password",value:d,onChange:function(e){var t=e.target;return b(t.value)}}),Object(S.jsx)(j.a,{className:"cta-button",variant:"contained",onClick:function(){y.loginToWolke({username:c,password:d}).then((function(e){e.success?t(d):console.log("login failed",e)}))},children:"Login"})]})},z={NONE:"none",OAUTH2:"oauth2",CARDS:"cards"},B=Object.values(z),F=(D={},Object(u.a)(D,z.NONE,null),Object(u.a)(D,z.OAUTH2,U),Object(u.a)(D,z.CARDS,E),D);var J=function(){var e=Object(a.useRef)(null),t=Object(a.useState)(!1),n=Object(i.a)(t,2),s=n[0],c=n[1],r=Object(a.useState)(""),u=Object(i.a)(r,2),v=u[0],x=u[1],_=Object(a.useState)(!1),w=Object(i.a)(_,2),N=w[0],k=w[1],C=Object(a.useState)(0),A=Object(i.a)(C,2),y=A[0],U=A[1],T=B[y],P=F[T],R=function(t){e.current&&e.current.contains(t.target)||k(!1)};return s?Object(S.jsxs)("div",{className:"App center-column",children:[Object(S.jsxs)("div",{className:"top-line",children:[Object(S.jsx)(l.a,{label:"admin password",type:"password",value:v,onChange:function(e){var t=e.target;return x(t.value)}}),Object(S.jsxs)(d.a,{variant:"contained",color:"primary",ref:e,"aria-label":"split button",children:[Object(S.jsx)(j.a,{children:B[y]}),Object(S.jsx)(j.a,{color:"primary",size:"small","aria-controls":N?"split-button-menu":void 0,"aria-expanded":N?"true":void 0,"aria-label":"select merge strategy","aria-haspopup":"menu",onClick:function(){k((function(e){return!e}))},children:Object(S.jsx)(g.a,{})})]}),Object(S.jsx)(b.a,{open:N,anchorEl:e.current,role:void 0,transition:!0,disablePortal:!0,children:function(e){var t=e.TransitionProps,n=e.placement;return Object(S.jsx)(m.a,Object(o.a)(Object(o.a)({},t),{},{style:{transformOrigin:"bottom"===n?"center top":"center bottom"},children:Object(S.jsx)(h.a,{children:Object(S.jsx)(O.a,{onClickAway:R,children:Object(S.jsx)(f.a,{id:"split-button-menu",children:B.map((function(e,t){return Object(S.jsx)(p.a,{disabled:!v,selected:t===y,onClick:function(e){return function(e,t){U(t),k(!1)}(0,t)},children:e},e)}))})})})}))}})]}),P&&Object(S.jsx)(P,{adminPassword:v})]}):Object(S.jsx)("div",{className:"App center-column",children:Object(S.jsx)(I,{onSuccess:function(e){x(e),c(!0)}})})};r.a.render(Object(S.jsx)(s.a.StrictMode,{children:Object(S.jsx)(J,{})}),document.getElementById("root"))}},[[86,1,2]]]);
//# sourceMappingURL=main.8a570ae5.chunk.js.map